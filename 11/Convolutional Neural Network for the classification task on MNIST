{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Convolutional Neural Network for the classification task on MNIST","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyP13PTcZ09/W3r5wGbpHjij"},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"2d1d4eb3967c4697834d503920bb678e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_271e333fa6b2478d8d4b690b6cb0cd0a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_160e7ce11ae649fab68f3f1e718924cd","IPY_MODEL_e76c0e401b1b4198a9b76acc1822aa92"]}},"271e333fa6b2478d8d4b690b6cb0cd0a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"160e7ce11ae649fab68f3f1e718924cd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_69c70250cebe4befb9ce7016df69a7c6","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5d3b43331d8841f1bdd7469f4a157d30"}},"e76c0e401b1b4198a9b76acc1822aa92":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_93fd2e0b2daa4150aff3d2f1296c9af8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:19&lt;00:00, 2032143.72it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_79a5858c3a174595ba5a3228b90b5824"}},"69c70250cebe4befb9ce7016df69a7c6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5d3b43331d8841f1bdd7469f4a157d30":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"93fd2e0b2daa4150aff3d2f1296c9af8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"79a5858c3a174595ba5a3228b90b5824":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ebbcb57ec6e84b1bb68a2df523d9fa1f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e1ea247a718f4417b823e20cb6d00c0d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1f451f8183474801988b60499f949af6","IPY_MODEL_ba7ea38130984b65baf2a1bd4127941f"]}},"e1ea247a718f4417b823e20cb6d00c0d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1f451f8183474801988b60499f949af6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_731026fb843d4e25936b31876ebecb5e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b4a90fee1cac40c890db1201fd800ee9"}},"ba7ea38130984b65baf2a1bd4127941f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_eb89337df09f4b3f844e9a781914e951","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 117277.44it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_addb033e343b4b2181a2ba64f7ed45bf"}},"731026fb843d4e25936b31876ebecb5e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b4a90fee1cac40c890db1201fd800ee9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"eb89337df09f4b3f844e9a781914e951":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"addb033e343b4b2181a2ba64f7ed45bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6d3705341bc74960a19c33bbcbd4a876":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_fa7e0a68cc194120b7d1e6e6e3b52128","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e35878906bbe4c65ae9df9ae4e8a59fc","IPY_MODEL_e5d288e6fa904518940e78873c06ed28"]}},"fa7e0a68cc194120b7d1e6e6e3b52128":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e35878906bbe4c65ae9df9ae4e8a59fc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b092ad0c38be44f39528e987271aebbf","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_680aa9578f2d474abee4511d50c01634"}},"e5d288e6fa904518940e78873c06ed28":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c94e1fb183de448ca8b972bf49a32b11","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:18&lt;00:00, 528539.21it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fc97b79f67294f8487165f642c1bd93f"}},"b092ad0c38be44f39528e987271aebbf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"680aa9578f2d474abee4511d50c01634":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c94e1fb183de448ca8b972bf49a32b11":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"fc97b79f67294f8487165f642c1bd93f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"aa14be3838634761a8ce10d8030dd977":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bf596a56162646ab85f5b1e064f22cf4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3026b2e89f4e445792981941360eff42","IPY_MODEL_0a805aa950e74f85a9d8edad8d47bf14"]}},"bf596a56162646ab85f5b1e064f22cf4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3026b2e89f4e445792981941360eff42":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_37ee2529d17b4faab162402be1a10d57","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a2296c1de88e4584a4ffd210000363f0"}},"0a805aa950e74f85a9d8edad8d47bf14":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_499791df7a5f4310a83a91cac7a26625","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:04&lt;00:00, 1885.94it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c083cdaa23b44a5a8b67e20e20a8ada0"}},"37ee2529d17b4faab162402be1a10d57":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a2296c1de88e4584a4ffd210000363f0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"499791df7a5f4310a83a91cac7a26625":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c083cdaa23b44a5a8b67e20e20a8ada0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"7CTKJvoNaDN6"},"source":["# 0. Setting\n","<hr>"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"id":"lViQWOgFaCpA","executionInfo":{"status":"ok","timestamp":1606483033978,"user_tz":-540,"elapsed":5184,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}},"outputId":"e1d48e36-4e56-4d11-92a4-4f58f7ea109d"},"source":["# import library\n","import torch\n","import torch.nn as nn\n","import matplotlib.pyplot as plt\n","import math\n","from pandas import Series, DataFrame\n","import pandas as pd\n","import numpy as np\n","import torch.nn.functional as F\n","import math\n","\n","\n","torch.__version__\n"],"execution_count":1,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'1.7.0+cu101'"]},"metadata":{"tags":[]},"execution_count":1}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hkB1yaCsaF9k","executionInfo":{"status":"ok","timestamp":1606483040711,"user_tz":-540,"elapsed":1034,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}},"outputId":"4e37b1d6-f061-4b3d-b4b0-80c8ff065a23"},"source":["# using gpu \n","use_cuda = True\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","print(torch.cuda.is_available())\n","print(device)"],"execution_count":2,"outputs":[{"output_type":"stream","text":["True\n","cuda\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"sYRIA056aV3r"},"source":["# 1. Data\n","<hr>"]},{"cell_type":"code","metadata":{"id":"sqgSPJpraM6q","executionInfo":{"status":"ok","timestamp":1606483043450,"user_tz":-540,"elapsed":911,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["from torchvision import transforms, datasets\n","\n","transform = transforms.Compose([\n","    transforms.ToTensor(),\n","    transforms.Normalize((0.1307,),(0.3081,)),  # mean value = 0.1307, standard deviation value = 0.3081\n","])\n"],"execution_count":3,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":429,"referenced_widgets":["2d1d4eb3967c4697834d503920bb678e","271e333fa6b2478d8d4b690b6cb0cd0a","160e7ce11ae649fab68f3f1e718924cd","e76c0e401b1b4198a9b76acc1822aa92","69c70250cebe4befb9ce7016df69a7c6","5d3b43331d8841f1bdd7469f4a157d30","93fd2e0b2daa4150aff3d2f1296c9af8","79a5858c3a174595ba5a3228b90b5824","ebbcb57ec6e84b1bb68a2df523d9fa1f","e1ea247a718f4417b823e20cb6d00c0d","1f451f8183474801988b60499f949af6","ba7ea38130984b65baf2a1bd4127941f","731026fb843d4e25936b31876ebecb5e","b4a90fee1cac40c890db1201fd800ee9","eb89337df09f4b3f844e9a781914e951","addb033e343b4b2181a2ba64f7ed45bf","6d3705341bc74960a19c33bbcbd4a876","fa7e0a68cc194120b7d1e6e6e3b52128","e35878906bbe4c65ae9df9ae4e8a59fc","e5d288e6fa904518940e78873c06ed28","b092ad0c38be44f39528e987271aebbf","680aa9578f2d474abee4511d50c01634","c94e1fb183de448ca8b972bf49a32b11","fc97b79f67294f8487165f642c1bd93f","aa14be3838634761a8ce10d8030dd977","bf596a56162646ab85f5b1e064f22cf4","3026b2e89f4e445792981941360eff42","0a805aa950e74f85a9d8edad8d47bf14","37ee2529d17b4faab162402be1a10d57","a2296c1de88e4584a4ffd210000363f0","499791df7a5f4310a83a91cac7a26625","c083cdaa23b44a5a8b67e20e20a8ada0"]},"id":"xg6JTlymatLg","executionInfo":{"status":"ok","timestamp":1606483051143,"user_tz":-540,"elapsed":3509,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}},"outputId":"a607cb6a-fbdc-40d0-a0da-60b259df4af0"},"source":["data_path = './MNIST'\n","\n","data_test   = datasets.MNIST(root = data_path, train= True, download=True, transform= transform)\n","data_train  = datasets.MNIST(root = data_path, train= False, download=True, transform= transform)\n","\n","print(\"the number of your training data (must be 10,000) = \", data_train.__len__())\n","print(\"hte number of your testing data (must be 60,000) = \", data_test.__len__())\n"],"execution_count":4,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./MNIST/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2d1d4eb3967c4697834d503920bb678e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./MNIST/MNIST/raw/train-images-idx3-ubyte.gz to ./MNIST/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./MNIST/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ebbcb57ec6e84b1bb68a2df523d9fa1f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./MNIST/MNIST/raw/train-labels-idx1-ubyte.gz to ./MNIST/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./MNIST/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6d3705341bc74960a19c33bbcbd4a876","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./MNIST/MNIST/raw/t10k-images-idx3-ubyte.gz to ./MNIST/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./MNIST/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"aa14be3838634761a8ce10d8030dd977","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./MNIST/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./MNIST/MNIST/raw\n","Processing...\n","Done!\n","the number of your training data (must be 10,000) =  10000\n","hte number of your testing data (must be 60,000) =  60000\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:480: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"iGD4nqaHbEzy"},"source":["# 2. Model\n","<hr>"]},{"cell_type":"code","metadata":{"id":"hOe3l4eaa16l","executionInfo":{"status":"ok","timestamp":1606486767740,"user_tz":-540,"elapsed":1091,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["class MyModel(nn.Module):\n","\n","    def __init__(self, num_classes=10, size_kernel=5):\n","\n","        super(MyModel, self).__init__()\n","\n","        # *********************************************************************\n","        # input parameter\n","        #\n","        # data size:\n","        #   mnist   : 28 * 28\n","        # \n","        # the tensor given to the model should be of shape [batch_size, 1, height, width]\n","        # because first convolution has in_channels = 1\n","        # *********************************************************************\n","        self.number_class   = num_classes\n","        self.size_kernel    = size_kernel        \n","        \n","        # *********************************************************************\n","        # feature layer\n","        # *********************************************************************\n","        self.conv1          = nn.Conv2d(1, 20, kernel_size=size_kernel, stride=1, padding=int((size_kernel-1)/2), bias=True)\n","        self.conv2          = nn.Conv2d(20, 50, kernel_size=size_kernel, stride=1, padding=int((size_kernel-1)/2), bias=True)\n","\n","        self.conv_layer1    = nn.Sequential(self.conv1, nn.MaxPool2d(kernel_size=2), nn.ReLU(True))\n","        self.conv_layer2    = nn.Sequential(self.conv2, nn.MaxPool2d(kernel_size=2), nn.ReLU(True))\n","\n","        self.feature        = nn.Sequential(self.conv_layer1, self.conv_layer2)\n","        \n","        # *********************************************************************\n","        # classifier layer\n","        # *********************************************************************\n","        self.fc1        = nn.Linear(50*7*7, 50, bias=True)\n","        self.fc2        = nn.Linear(50, num_classes, bias=True)\n","\n","        self.fc_layer1  = nn.Sequential(self.fc1, nn.ReLU(True))\n","        self.fc_layer2  = nn.Sequential(self.fc2, nn.ReLU(True))\n","\n","        self.classifier = nn.Sequential(self.fc_layer1, self.fc_layer2)\n","        \n","        self._initialize_weight()        \n","        \n","    \n","    def _initialize_weight(self):\n","\n","        for m in self.modules():\n","            \n","            if isinstance(m, nn.Conv2d):\n","                \n","                #nn.init.xavier_uniform_(m.weight, gain=math.sqrt(2))\n","                nn.init.kaiming_normal_(m.weight.data, a=0, mode='fan_in')\n","\n","                if m.bias is not None:\n","\n","                    m.bias.data.zero_()\n","\n","            elif isinstance(m, nn.Linear):\n","\n","                #nn.init.xavier_uniform_(m.weight, gain=math.sqrt(2))\n","                nn.init.kaiming_normal_(m.weight.data, a=0, mode='fan_in')\n","                \n","                if m.bias is not None:\n","\n","                    m.bias.data.zero_()\n","\n","\n","    def forward(self, x):\n","        x = x.to(device)\n","        x = self.feature(x)\n","        x = x.view(x.size(0), -1)\n","        x = self.classifier(x)\n","\n","        return x\n"],"execution_count":44,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"yRNF2mR5bgbA"},"source":["# 3. Loss Function\n","<hr>"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Kw5mL8RobkEx","executionInfo":{"status":"ok","timestamp":1606486783608,"user_tz":-540,"elapsed":697,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}},"outputId":"61b526fc-4b9a-4786-909d-7fb77fa2f040"},"source":["model = MyModel(10, 5).to(device)\n","criterion = nn.CrossEntropyLoss()\n","train_y_pred = model.forward(data_train.data.unsqueeze(dim=1).float())\n","train_y = data_train.targets.to(device)\n","temp_loss = criterion(train_y_pred, train_y)\n","print(temp_loss.data.item())"],"execution_count":46,"outputs":[{"output_type":"stream","text":["166.1278076171875\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"sEsHl_80816c"},"source":["# 4. Optimization\n","<hr>"]},{"cell_type":"markdown","metadata":{"id":"iCxbwftz-Q2k"},"source":["Define Train Function"]},{"cell_type":"code","metadata":{"id":"PUECilgxbumh","executionInfo":{"status":"ok","timestamp":1606487273026,"user_tz":-540,"elapsed":911,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def train(model, criterion, train_loader, optimizer, batch_size):\n","  \n","  model.train()\n","  loss_sum = 0\n","  acc_sum = 0\n","  iteration = 0\n","  for xs, ts in iter(train_loader):\n","\n","    iteration = iteration + 1\n","    optimizer.zero_grad()\n","    y_pred = model(xs)\n","    ts = ts.to(device)\n","    loss = criterion(y_pred, ts)\n","    loss.backward()\n","    optimizer.step()\n","    \n","    loss_sum = loss_sum + float(loss)\n","    zs = y_pred.max(1, keepdim=True)[1] # first column has actual prob\n","    acc_sum = acc_sum + zs.eq(ts.view_as(zs)).sum().item()/batch_size\n","  \n","  loss_avg = math.trunc(loss_sum/iteration * 100) / 100\n","  acc_avg = math.trunc(acc_sum/iteration * 100) / 100\n","  \n","  return loss_avg, acc_avg"],"execution_count":66,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"dcK39hpG-VF5"},"source":["Define Test Function"]},{"cell_type":"code","metadata":{"id":"CzMC4pAp-SuO","executionInfo":{"status":"ok","timestamp":1606487267862,"user_tz":-540,"elapsed":943,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def test(model,criterion, test_loader, batch_size):\n","  model.eval()\n","  loss_sum = 0\n","  acc_sum = 0\n","  iteration = 0\n","  with torch.no_grad():\n","    for xs, ts in iter(test_loader):\n","      iteration = iteration + 1\n","      ts = ts.to(device)\n","      y_pred = model(xs)\n","      loss_sum = loss_sum + criterion(y_pred, ts).data.item()\n","      zs = y_pred.max(1, keepdim=True)[1]\n","      acc_sum = acc_sum + zs.eq(ts.view_as(zs)).sum().item()/batch_size\n","  \n","  loss_avg = math.trunc(loss_sum/iteration * 100) / 100\n","  acc_avg = math.trunc(acc_sum/iteration * 100) / 100\n","\n","  return loss_avg, acc_avg"],"execution_count":65,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"nBaK5IVA-Yle"},"source":["Define Gradient Descent Fucntion"]},{"cell_type":"code","metadata":{"id":"j8in-lnH-W2i","executionInfo":{"status":"ok","timestamp":1606486882717,"user_tz":-540,"elapsed":762,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def gradient_descent(model, optimizer, criterion, batch_size, num_epochs):\n","\n","  # batching\n","  train_loader = torch.utils.data.DataLoader(\n","      data_train,\n","      batch_size=batch_size,\n","      num_workers=4,\n","      shuffle=True,\n","      drop_last=True)\n","  \n","  test_loader = torch.utils.data.DataLoader(\n","      data_test,\n","      batch_size=batch_size,\n","      num_workers=4,\n","      shuffle=False,\n","      drop_last=True)\n","  \n","  \n","  # return variables\n","  train_loss_list, train_acc_list = [], []\n","  test_loss_list, test_acc_list = [], []\n","\n","  \n","  # run training & testing\n","  for epoch in range(num_epochs + 1):\n","\n","    train_loss_avg, train_acc_avg = train(model, criterion, train_loader, optimizer, batch_size)\n","    test_loss_avg, test_acc_avg = test(model, criterion, test_loader, batch_size)\n","    \n","    # add loss and accuracy data\n","    train_loss_list.append(train_loss_avg)\n","    train_acc_list.append(train_acc_avg)\n","    test_loss_list.append(test_loss_avg)\n","    test_acc_list.append(test_acc_avg)\n","\n","    # print\n","    if epoch % 10 != 0 :\n","      continue\n","\n","    print(\"epoch : \", epoch, \" -------------------------------------- \")\n","    print(\"train loss : {}      accuracy = {}\".format(train_loss_avg, train_acc_avg))\n","    print(\"test loss : {}       accuracy = {}\".format(test_loss_avg, test_acc_avg))\n","\n","\n","  return train_loss_list, train_acc_list, test_loss_list, test_acc_list\n"],"execution_count":51,"outputs":[]},{"cell_type":"code","metadata":{"id":"nOMlKMvs_I5P","executionInfo":{"status":"ok","timestamp":1606487467883,"user_tz":-540,"elapsed":1422,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def gradient_descent_with_scheduler(scheduler, model, optimizer, criterion, batch_size, num_epochs, train_loss_list, train_acc_list, test_loss_list, test_acc_list):\n","\n","  # batching\n","  train_loader = torch.utils.data.DataLoader(\n","      data_train,\n","      batch_size=batch_size,\n","      num_workers=4,\n","      shuffle=True,\n","      drop_last=True)\n","  \n","  test_loader = torch.utils.data.DataLoader(\n","      data_test,\n","      batch_size=batch_size,\n","      num_workers=4,\n","      shuffle=False,\n","      drop_last=True)\n","\n","  \n","  # return variables\n","  #train_loss_list, train_acc_list = [], []\n","  #test_loss_list, test_acc_list = [], []\n","\n","  \n","  # run training & testing\n","  for epoch in range(num_epochs + 1):\n","\n","    train_loss_avg, train_acc_avg = train(model, criterion, train_loader, optimizer, batch_size)\n","    test_loss_avg, test_acc_avg = test(model, criterion, test_loader, batch_size)\n","    scheduler.step(train_loss_avg)\n","        \n","    # add loss and accuracy data\n","    train_loss_list.append(train_loss_avg)\n","    train_acc_list.append(train_acc_avg)\n","    test_loss_list.append(test_loss_avg)\n","    test_acc_list.append(test_acc_avg)\n","\n","    # print\n","    if epoch % 10 != 0 :\n","      continue\n","\n","    print(\"epoch : \", epoch, \" -------------------------------------- \")\n","    print(\"train loss : {}      accuracy = {}\".format(train_loss_avg, train_acc_avg))\n","    print(\"test loss : {}       accuracy = {}\".format(test_loss_avg, test_acc_avg))\n"],"execution_count":72,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"vGh6KmWR_XbX"},"source":["# 5. Plot Function\n","<hr>"]},{"cell_type":"code","metadata":{"id":"ndMV9T4F_Nno","executionInfo":{"status":"ok","timestamp":1606485473164,"user_tz":-540,"elapsed":1020,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def plot_loss(train_loss_list, test_loss_list):\n","  plt.title(\"Loss\")\n","  plt.plot(train_loss_list, c = 'red', label = 'train loss')\n","  plt.plot(test_loss_list, c = 'blue', label = 'test loss')\n","  plt.legend(loc = 'lower right')\n","  plt.show()"],"execution_count":34,"outputs":[]},{"cell_type":"code","metadata":{"id":"cHEs1N9t_vNL","executionInfo":{"status":"ok","timestamp":1606485501588,"user_tz":-540,"elapsed":990,"user":{"displayName":"장예솔","photoUrl":"","userId":"10358588701743689220"}}},"source":["def plot_accuracy(train_acc_list, test_acc_list):\n","  plt.title(\"Accuracy\")\n","  plt.plot(train_acc_list8, c = 'red', label = 'train accuracy')\n","  plt.plot(test_acc_list8, c = 'blue', label = 'test accuracy')\n","  plt.legend(loc = 'lower right')\n","  plt.show()"],"execution_count":35,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"pjlcXOQE_22Z"},"source":["# 6. Run\n","<hr>"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"t5zubL3QCj4R","outputId":"7ada030c-d608-45d5-8631-ed46cbe135d6"},"source":["# model\n","num_classes=10\n","size_kernel=5\n","model1 = MyModel(num_classes, size_kernel).to(device)\n","\n","# mini-batch size\n","batch_size = 32\n","\n","# num of epochs\n","num_epochs = 50\n","\n","# learning rate\n","learning_rate = 0.01\n","\n","# optimizer\n","optimizer = torch.optim.SGD(model1.parameters(), lr = learning_rate, weight_decay=0.0001)\n","scheduler = torch.optim.lr_scheduler.ReduceLROnPlateau(optimizer, 'min', factor=0.5, patience = 5, verbose=True)   \n","\n","# loss function\n","criterion = nn.CrossEntropyLoss()\n","\n","# run\n","train_loss_list1, train_acc_list1, test_loss_list1, test_acc_list1 = [], [], [], []\n","gradient_descent_with_scheduler(scheduler, model1, optimizer, criterion, batch_size, num_epochs, train_loss_list1, train_acc_list1, test_loss_list1, test_acc_list1)\n","\n","# plot\n","plot_loss(train_loss_list1, test_loss_list1)"],"execution_count":null,"outputs":[{"output_type":"stream","text":["epoch :  0  -------------------------------------- \n","train loss : 2.2      accuracy = 0.18\n","test loss : 2.15       accuracy = 0.18\n","epoch :  10  -------------------------------------- \n","train loss : 1.13      accuracy = 0.6\n","test loss : 1.18       accuracy = 0.59\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"aXjcwfTqHOi8"},"source":[""],"execution_count":null,"outputs":[]}]}